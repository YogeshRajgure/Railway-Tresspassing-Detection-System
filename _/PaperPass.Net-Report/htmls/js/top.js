(function(l,d){var e=l.operateState.getHeaderState(Report.report_id);t(e);d(".HeaderButton").click(function(){var e=d(".paper-header").css("display");l.operateState.saveHeaderState(Report.report_id,e);t(e);N()});function t(e){if(e=="block"||e==""){d(".paper-header").hide();d("#m-content").css("top","40px");d(".overall-similarity").show();d(".header_logo").show();d(".clickimg").css("background-position","-10px -98px");d(".dropdown-menu ul").css("top","40px")}else{d(".paper-header").show();d("#m-content").css("top","140px");d(".overall-similarity").hide();d(".header_logo").hide();d(".clickimg").css("background-position","-71px -98px");d(".dropdown-menu ul").css("top","140px")}}var c=l.operateState.getLanguage(Report.report_id);if(c!=""){c=typeof multilingual[c]=="undefined"?"English":c}else{c=typeof multilingual[user_language]=="undefined"?"English":user_language}r(c);function r(t){d("*[data-lang]").each(function(){var e=d(this).data().lang;d(this).html(multilingual[t][e])})}var i=l.operateState.getALink(Report.report_id);var a=l.operateState.getTabName(Report.report_id);s(a);p();d("#childIframe").attr("src",i);d("#m-nav .active_li").each(function(){var e=d(this).find(".detailed_description").data().lang;if(a==e){d(this).addClass("active");d(this).siblings().removeClass("active")}if(a=="UseHelp"){d("#nav_ul .active_li.active").removeClass("active")}});d("#m-nav .active_li").click(function(){var e=d(this).find(".detailed_description").data().lang;var t=d(this).find("a").attr("href");l.operateState.saveALink(Report.report_id,t);l.operateState.saveTabName(Report.report_id,e);s(e);if(e=="UseHelp"){d("#nav_ul .active_li.active").removeClass("active")}});function s(e){var t="";if(e==""||e=="DetailReport"){t+='<div class="layui_fixed_layer"></div>'+'<div class="layui_loading_shade">'+'<div class="layui-layer main_layer">'+'<div class="layui-layer-content">'+multilingual[c].LoadingReport+"</div>"+"</div>"+"</div>";d("#m-content").append(t);var i=l.operateState.getFoldState(Report.report_id);var a=l.operateState.getInitDetailReport(Report.report_id);o(i);n(a)}}function n(e){if(is_has_word){if(e==""||e=="word"){d(".layui_loading_shade").css("background","#484f52")}else{d(".layui_loading_shade").css("background","#e7e7e7")}}else{d(".layui_loading_shade").css("background","#e7e7e7")}}function o(e){if(e=="none"){d(".layui_loading_shade").css("width","100%")}else{d(".layui_loading_shade").css("width","70%")}}function p(){var e=document.documentElement.clientWidth;d("#nav_ul li").each(function(){if(e>1280){d(".tab li a").css("padding","0 20px");d(".nav-tit h4").css("font-size","20px")}else{d(".tab li a").css("padding","0 10px");d(".nav-tit h4").css("font-size","16px")}})}d(".dropdown-toggle").click(function(){if(d(".download-format").css("display")=="block"){d(".customize-select .dropdown-menu ul").css("right","123px")}else{d(".customize-select .dropdown-menu ul").css("right","81px")}d(".customize-select .dropdown-menu").toggle();d(".customize-select .caret").css({transform:"rotate(180deg)"})});d(".dropdown-menu *[data-option]").each(function(){if(c==d(this).data().option){d(".customize-select-text").html(d(this).html());d(".dropdown-menu").find("li.selected").removeClass("selected");d(this).parent("li").addClass("selected")}});d(document).on("click",".customize-select .dropdown-menu li > a",function(e){e.preventDefault();location.reload();var t=d(this).text();var i=d(this).parent("li");if(!i.hasClass("ignore")){var a=d(".customize-select");var s=a.attr("data-name");var n=a.find('input[name="'+s+'"]');d(".dropdown-menu").find("li.selected").removeClass("selected");i.addClass("selected");a.find(".customize-select-text").html(t);n.val(t)}var o=d(this).attr("data-option");c=typeof multilingual[o]=="undefined"?"English":o;r(c);l.operateState.saveLanguage(Report.report_id,c);R.contentWindow.postMessage({leng:c},"*")});d(".download-format").click(function(){d(this).find(".dropdown-menu").toggle()});d(".customize-select .dropdown-menu").click(function(){d(this).hide();d(".customize-select .caret").css({transform:"rotate(0deg)"})});d(".help_img,.download_img").mousemove(function(){d(this).parents(".ML20").find(".detailed_description").css("display","block")}).mouseout(function(){d(this).parents(".ML20").find(".detailed_description").css("display","none")});window.addEventListener("message",function(e){if(e.data.bodyDOM&&e.data.sheetCSS){y(e.data.bodyDOM,e.data.sheetCSS)}if(e.data=="switch-detail-text"){l.operateState.saveInitDetailReport(Report.report_id,"text");s("DetailReport");d(".popover").css("visibility","hidden")}if(e.data=="switch-detail-word"){l.operateState.saveInitDetailReport(Report.report_id,"word");s("DetailReport");d(".popover").css("visibility","hidden")}if(e.data=="Page_Loading"){d(".layui_loading_shade").remove();d(".layui_fixed_layer").remove()}if(e.data.FoldState){E(e.data.FoldState)}if(e.data=="get_language"){R.contentWindow.postMessage({leng:c},"*")}});function v(e){var t="";t+='<div class="popover bookmark" id="'+e+'">'+'<div class="popover-child">'+'<div class="popover-title flex-between">'+'<div class="flex">'+'<div class="font-bold">'+multilingual[c].DirectoryNavigation+"</div>"+'<div class="mclick_show"><span>[</span><span class="mclick_span">'+multilingual[c].ExpandAll+'</span><i class="g-arrow-i"></i><span>]</span></div>'+"</div>"+'<button type="button" class="close"><span aria-hidden="true"></span></button>'+"</div>"+'<div class="popover-content">'+'<div class="overflow_ul"></div>'+"</div>"+"</div>"+"</div>";d("#m-content").append(t)}function u(e){var i="";if(e.length==0){i+='<div style="text-align: center;margin-left: -40px;padding: 15px 0;">'+multilingual[c].EmptyDirectoryNavigation+"</div>"}else{e.forEach(e=>{var t=e.children!="undefined"&&e.children&&e.children.length?u(e.children):null;if(t!=null){i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_img mselect_img_detail"></div>'+'<div class="mselect_tit">'+'<a href="htmls/word/word_report.html'+e.anchorPoint+'" target="left" class="third-class">'+e.content+"</a>"+"</div>"+"</div>"+t+"</div>"}else{i+='<div class="layui-nav-third-child">'+'<div class="flex">'+'<div class="mselect_tit ML20">'+'<a href="htmls/word/word_report.html'+e.anchorPoint+'" target="left" class="third-class">'+e.content+"</a>"+"</div>"+"</div>"+"</div>"}})}return i}function h(e){return JSON.stringify(JSON.parse(e)).replace(/</g,"&lt;").replace(/>/g,"&gt;")}v("detail_report");var g=JSON.parse(h(detail_json));u=u(g);d("#detail_report .overflow_ul").html(u);d(".overflow_ul").children(".layui-nav-third-child").removeClass("layui-nav-third-child");d(".third-class").each(function(){var e=40;var t=d(this).text().trim();var i=t.length;if(i>e){d(this).html(t.substring(0,e)+"...")}});d(".mselect_img").click(function(){var e=d(this).parent().siblings(".layui-nav-third-child");if(d(this).hasClass("opened")){e.hide();e.find(".mselect_img").removeClass("opened");e.find(".mselect_img").css("background-position","-115px -245px");d(this).css("background-position","-115px -245px");d(this).removeClass("opened")}else{e.show();d(this).css("background-position","-77px -245px");d(this).addClass("opened")}});function m(e){var i=true;d.each(e,function(e,t){if(!d(t).hasClass("opened")){i=false}});if(i){d(".mclick_span").text(multilingual[c].CollapseAll);d("i.g-arrow-i").css({"border-color":"transparent transparent #56b282",top:"13px"})}else{d(".mclick_span").text(multilingual[c].ExpandAll);d("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"})}}d(".mselect_img_detail").click(function(){var e=d(".mselect_img_detail");m(e)});if(d(".layui-nav-third-child").length==0){d(".mclick_show").hide()}d(".mclick_show").click(function(){var e=d(this).parent().parent().next().find(".layui-nav-third-child");var t=d(this).parent().parent().next().find(".mselect_img");if(e.is(":hidden")){if(d(this).find(".mclick_span").text()==multilingual[c].CollapseAll){e.hide();t.css("background-position","-115px -245px");d(this).find(".mclick_span").text(multilingual[c].ExpandAll);d("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"});d(".mselect_img").removeClass("opened")}else{e.show();t.css("background-position","-77px -245px");d(this).find(".mclick_span").text(multilingual[c].CollapseAll);d("i.g-arrow-i").css({"border-color":"transparent transparent #56b282",top:"13px"});d(".mselect_img").addClass("opened")}}else{e.hide();t.css("background-position","-115px -245px");d(this).find(".mclick_span").text(multilingual[c].ExpandAll);d("i.g-arrow-i").css({"border-color":"#56b282 transparent transparent",top:"18px"});d(".mselect_img").removeClass("opened")}});var f="";f+='<div class="popover bookmark" id="page_navigation">'+'<div class="popover-child">'+'<div class="popover-title flex-between">'+'<div class="flex">'+'<div class="font-bold">'+multilingual[c].WebpageNavigation+"</div>"+'<ul class="nav-btns clearfix">'+"<li><span></span></li>"+'<li class="active"><span></span></li>'+"<li><span></span></li>"+"</ul>"+"</div>"+'<button type="button" class="close"><span aria-hidden="true"></span></button>'+"</div>"+'<div class="overflow_ul">'+'<div id="mbxsgxktna" style="width: 284px;"></div>'+"</div>"+"</div>"+"</div>";d("#m-content").append(f);function _(e){if(e==""){d(".nav-btns").hide();e+='<div style="float:none;color:#000000">'+multilingual[c].EmptyWebPageNavigation+"</div>"}else{d(".nav-btns").show()}return e}var w=document.createElement("style");d("head").append(w);function y(e,t){d("style").html(t);var i=_(e);d("#mbxsgxktna").html(i);var a=document.querySelectorAll(".upkmzjakmc");d.each(a,function(){d(this).css("transform","scale(1)");var e=this.getBoundingClientRect().width;var t=this.getBoundingClientRect().height;var i=e/t;var a=155/t;var s=110/e;if(i<793.33/1121.33){d(this).css("transform","scale("+a+")")}else{d(this).css("transform","scale("+s+")")}e=this.getBoundingClientRect().width;t=this.getBoundingClientRect().height;d(this).parent(".jcjymywwzd").css("width",Math.ceil(e));d(this).parent(".jcjymywwzd").css("height",t);x();var n=d(this).parent(".jcjymywwzd").attr("id");var o='<div class="page-nav-id">'+n+"</div>";d(this).parent(".jcjymywwzd").append(o)});d("#Add_height").remove()}function x(){d.each(d(".jcjymywwzd"),function(e,t){var i=this.getBoundingClientRect().width;var a=(112-i)/2+15;d(this).css("margin-left",a).css("margin-right",a)})}function b(i,a){d(".page-nav-id").css("color","#343544");d(".jcjymywwzd").removeClass("active");d(".upkmzjakmc").each(function(e){if(i==e+1){d(this).parent(".jcjymywwzd").addClass("active");d(this).next(".page-nav-id").css("color","#35b372");if(a=="false"){if(this.nextElementSibling!=null)this.nextElementSibling.scrollIntoView(false)}var t=document.getElementById("childIframe");t.contentWindow.postMessage({page_nav_click:"false"},"*")}});x()}d(document).on("click",".nav-btns li",function(){d(this).siblings().removeClass("active");d(this).addClass("active");d("#page_navigation").find("li").each(function(e,t){var e=e+1;if(e==1&&d(this).hasClass("active")){d("#page_navigation").find("#mbxsgxktna").css("width","142px");k(e)}else if(e==2&&d(this).hasClass("active")){d("#page_navigation").find("#mbxsgxktna").css("width","284px");k(e)}else if(e==3&&d(this).hasClass("active")){d("#page_navigation").find("#mbxsgxktna").css("width","426px");k(e)}})});function k(e){var t=l.operateState.getInitDetailReport(Report.report_id);if(t=="word"||t==""){l.operateState.savePageNavState(Report.report_id,e)}else{l.operateState.savePTPageNavState(Report.report_id,e)}}function S(){var e=l.operateState.getInitDetailReport(Report.report_id);if(e=="word"||e==""){return l.operateState.getPageNavState(Report.report_id)}else{return l.operateState.getPTPageNavState(Report.report_id)}}d(document).delegate(".upkmzjakmc","click",function(){d(this).next(".page-nav-id").css("color","#35b372");d(".jcjymywwzd").removeClass("active");d(this).parent(".jcjymywwzd").addClass("active");var e=d(this).parent(".jcjymywwzd").attr("id");var t={EnterId:e,page_nav_click:"true"};R.contentWindow.postMessage(t,"*");x()});function C(e){d("#page_navigation").find(".nav-btns li").each(function(){if(d(this).hasClass("active")){d(this).removeClass("active")}});if(e=="1"){d("#page_navigation").find(".nav-btns li:first-child").addClass("active");d("#page_navigation").find("#mbxsgxktna").css("width","142px")}else if(e=="2"||e==""){d("#page_navigation").find(".nav-btns li:nth-child(2)").addClass("active");d("#page_navigation").find("#mbxsgxktna").css("width","284px")}else if(e=="3"){d("#page_navigation").find(".nav-btns li:last-child").addClass("active");d("#page_navigation").find("#mbxsgxktna").css("width","426px")}}d("#m-nav a").click(function(){d(".popover").css("visibility","hidden")});var R=document.getElementById("childIframe");var j=l.Paper.tab();var z=l.Paper.textSectionSave(null);d(function(){if("undefined"===typeof localStorage||"undefined"===typeof JSON){d("body").append('<div class="alert-warning"><p>'+multilingual[c].SupportBrowser+"</p></div>")}d(document).on("click",'[tab-a="ul"] .active_li',function(){j.call(this)});var e=d("#detail_report").css("visibility");var t=d("#page_navigation").css("visibility");var i={child1:e,child3:t,leng:c};d(".close").click(function(){d(".popover").css("visibility","hidden");R.contentWindow.postMessage(i,"*")});R.contentWindow.postMessage(i,"*");d(document).on("click","[tpl-section-save=btn]",function(){z.call(this)});d(document).on("click","[tpl-section-cancle=btn],[tpl-section-save=btn],.layui-layer-setwin",function(){d("#section-edit-modal").css("display","none");d("#modify-document-modal").css("display","none");d(".layui-layer").css("display","none")});window.addEventListener("message",function(e){d("#detail_report").css("visibility",e.data.state1);d("#page_navigation").css("visibility",e.data.navState);if(e.data.state1=="visible"||e.data.navState=="visible"){N()}if(e.data.navState=="visible"){var t=S();C(t);b(e.data.pageNum,"false")}if(e.data.PageNum){b(e.data.PageNum,e.data.page_nav_click)}if(e.data.section_edit){d("#section-edit-modal").css("display","block");d("#layui-layer-section").css("display","block");var i=JSON.parse(h(section_edit_json));var a=e.data.section_edit.trim();d(".section-txt.section-txt-prev").text("");d.each(i[a],function(e,t){if(t.score>=.4&&t.score<.7){var i=d('<span class="orange">'+t.content+"</span>")}else if(t.score>=.7){var i=d('<span class="red">'+t.content+"</span>")}else{var i=d("<span>"+t.content+"</span>")}d(".section-txt.section-txt-prev").append(i)});d(".section-id").text(a);var s=l.Paper.textSectionEdit();s.call(this)}if(e.data.modify_document){d("#modify-document-modal").css("display","block");d("#layui-layer-document").css("display","block");d("#modifyDocument").attr("src","htmls/modify_document.html")}})});function E(e){var t=document.documentElement.clientWidth;if(e=="none"){d(".bookmark").css({width:t*.29,left:"auto",right:"72px"})}else{d(".bookmark").css({width:t*.29,left:t*.7-30,right:"auto"})}}N();function N(){var e=document.documentElement.clientWidth;var t=document.documentElement.clientHeight;var i=l.operateState.getTabName(Report.report_id);var a=l.operateState.getFoldState(Report.report_id);var s=d(".paper-header").css("display");if(s=="block"){d(".overflow_ul").css("height",t-220)}if(s=="none"){d(".overflow_ul").css("height",t-120)}if(a=="none"){d(".bookmark").css({width:e*.29,left:"auto",right:"72px"})}else{d(".bookmark").css({width:e*.29,left:e*.7-30,right:"auto"})}}d(window).resize(function(){p();N()})})(Report,jQuery);